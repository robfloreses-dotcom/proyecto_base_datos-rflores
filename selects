SELECT
  'Producto ' || g,
  (random() * 50 + 1)::DECIMAL(10,2),
  (random() * 4 + 1)::INT
FROM generate_series(1,25) g;

SELECT
  'Cliente ' || g,
  'cliente' || g || '@mail.com',
  '099000' || g
FROM generate_series(1,30) g;

SELECT
  (random() * 29 + 1)::INT,
  DATE '2024-01-01' + (random() * 90)::INT,
  0
FROM generate_series(1,30);

SELECT
  v.id_venta,
  p.id_producto,
  (random() * 5 + 1)::INT AS cantidad,
  p.precio AS precio_unitario,
  ((random() * 5 + 1)::INT * p.precio) AS subtotal
FROM generate_series(1,100)
JOIN rflores.venta v ON true
JOIN rflores.producto p ON true
ORDER BY random()
LIMIT 100;

SELECT DISTINCT c.nombre, v.fecha_venta
FROM rflores.cliente c
JOIN rflores.venta v ON c.id_cliente = v.id_cliente
WHERE v.fecha_venta BETWEEN '2024-01-01' AND '2024-03-31';

SELECT c.nombre, SUM(d.subtotal) AS total_comprado
FROM rflores.cliente c
JOIN rflores.venta v ON c.id_cliente = v.id_cliente
JOIN rflores.detalle_venta d ON v.id_venta = d.id_venta
GROUP BY c.nombre; 

SELECT p.nombre, SUM(d.cantidad) AS total_vendido
FROM rflores.producto p
JOIN rflores.detalle_venta d ON p.id_producto = d.id_producto
GROUP BY p.nombre
ORDER BY total_vendido DESC;
